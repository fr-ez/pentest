package main

import (
	"fmt"
	"os"
	"os/exec"
	"syscall"
)

func Scan(ip string, light bool) {
	Prepare()
	if light {
		ExecuteLightScan(ip)
	} else {
		ExecuteHeavyScan(ip)
	}
}

func ExecuteLightScan(ip string) {
	fmt.Printf("Executing light nmap scan on %s.\n", ip)
	//nmapCommand := fmt.Sprintf("nmap -T4 -Pn -sV --top-ports=20 %s -oN scan/top-ports-scan.nmap", ip)
	binary, err := exec.LookPath("nmap")
	if err != nil {
		panic(err)
	}
	command := []string{"-Pn", "-T4", "-sV", "--top-ports=20", ip}
	env := os.Environ()
	execErr := syscall.Exec(binary, command, env)
	if execErr != nil {
		panic (execErr)
	}
}

func ExecuteHeavyScan(ip string) {
	fmt.Printf("\nExecuting heavy nmap scan on %s\n", ip)
}
