#!/bin/bash

# Set IP of target
clear
tput setaf 4; echo Enter IP:
tput setaf 7;
echo
read ip

# Create folder structure
echo Creating folder structure for $ip
mkdir $ip && mkdir $ip/exploits && mkdir $ip/scans
cd $ip
echo Done
echo

echo ---------------------------------------------
echo Port Scan - Host $ip
echo ---------------------------------------------
echo

# Nmap Fast Port Scan
tput setaf 2;
echo
echo Running fast Nmap scan - Host $ip
tput setaf 7;
echo **Nmap Fast Scan - Port Scan and Version Scan**
nmap -F -sV -Pn -n -T3 -oN scans/nmap-fast-scan.nmap $ip --stats-every 10s
echo

echo ---------------------------------------------
echo Vulnerability Scan - Host $ip
echo ---------------------------------------------

# SMB Vuln Scan
tput setaf 2;
echo Running enum4linux scan
tput setaf 7;
sleep 5
echo Check for SMB services...
if grep "smb" scans/nmap-fast-scan.nmap; then
	echo **SMB Scan**
	enum4linux -a -v $ip > scans/smb-enum4linux.scan
	nmap --script="smb*" --script-args vulns.showall $ip -oN scans/smb-nmap.scan
else
	echo No SMB Services found on $ip
fi
echo

# HTTP Vuln Scan
tput setaf 2;
echo 
echo Running HTTP scan
tput setaf 7;
sleep 5
echo **Checking for HTTP services...**
if grep "80/tcp" scans/nmap-fast-scan.nmap; then
	echo
	echo Running Nmap NSE http scripts
	nmap --script="http-sitemap-gen*,http-methods,http-mobile*, \
		http-open*,http-sql*,http-userdir*,http-vhosts,http-webdav*, \
		http-iis-webdav*,http-enum*,http-frontpage*, \
		http-useragent*" -oN scans/nmap-http.scan $ip
	echo Fetching robots.txt
	wget http://$ip/robots.txt -O robots.txt
	echo Running nikto scan
	nikto -h $ip > scans/nikto.scan
	echo Gosbusting the thing!
	gobuster -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://$ip -o scans/gobuster.scan
else 
	echo No HTTP Services Found on $ip
fi
echo

# Run heavy Nmap Scan
tput setaf 2;
echo
echo Running Heavy Nmap Scan - Host $ip
tput setaf 7;
sleep 5
echo **Nmap Heavy Scan**
nmap -Pn -n -T4 --top-ports=10000 -oN scans/nmap-heavy-scan.nmap $ip -vv
echo
